angular.module("ngSecured",["ui.router"]).run(["ngSecured",function(){}]),angular.module("ngSecured").directive("asRole",["ngSecured","$animate",function(a,b){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,f,g){var h,i;c.$watch(function(){return e.asRole},function(f){a.includeRole(f)?i||(i=c.$new(),g(i,function(a){a[a.length++]=document.createComment(" end asRole: "+e.asRole+" "),h={clone:a},b.enter(a,d.parent(),d)})):(h&&(b.leave(getBlockElements(h.clone)),h=null),i&&(i.$destroy(),i=null))})}}}]),angular.module("ngSecured").provider("ngSecured",["$stateProvider",function(a){var b="private__ngSecured",c={BASE_STATE:b,NOT_AUTHENTICATED:b+".notAuthenticated",NOT_AUTHORIZED:b+".notAuthorized"},d={loginState:c.NOT_AUTHENTICATED,unAuthorizedState:c.NOT_AUTHORIZED,isAuthenticated:function(){return!1},postLoginState:c.NOT_AUTHENTICATED};a.state(c.BASE_STATE,{}),a.state(c.NOT_AUTHENTICATED,{views:{"@":{template:"please login to see this page."}}}),a.state(c.NOT_AUTHORIZED,{views:{"@":{template:"You are not authorized to see this page."}}}),this.secure=function(a){angular.extend(d,a)},this.$get=["$rootScope","$state","$q",function(a,b,e){function f(){h=d.postLoginState}function g(){h&&b.go(h,i)}var h,i,j;return f(),a.$on("$stateChangeStart",function(a,c,e){c.secured&&(d.isAuthenticated()?c.secured.hasOwnProperty("role")&&(!j||j.indexOf(c.secured.role))&&(a.preventDefault(),b.go(d.unAuthorizedState)):(a.preventDefault(),h=c.name,i=e,b.go(d.loginState)))}),{defaultStateNames:c,_initVars:f,login:function(a){if(!d.login||!angular.isFunction(d.login))throw new Error("login function must be configured");var b=d.login(a),c=this;e.when(b).then(function(a){a&&c.setRoles(a),g()})},setRoles:function(a){if(angular.isString(a))j=[a];else{if(!angular.isArray(a))throw new Error("roles must be a String or an Array");j=a}},getRoles:function(){return j},includesRole:function(a){return j&&-1!==j.indexOf(a)?!0:!1}}}]}]);